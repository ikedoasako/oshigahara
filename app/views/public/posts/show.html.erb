<div class="container mt-5">
  <div class= "row">
    <div class="col-md-3">
      <%= render 'list', posts: @posts, user: @user %>
    </div>
    <div class= "col-md-8 offset-md-1">
      <h3>合戦！<h6>投稿内容詳細</h6></h3>
      <table class="table">
        <thead>
          <tr>
            <th class="text-nowrap pr-lg-5">投稿者名</th>
            <th class="text-nowrap pr-lg-5">所属軍</th>
            <th class="text-nowrap pr-lg-5">タイトル</th>
            <th>投稿内容</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><%= link_to @user.name, users_my_page_path(@post.user.id) %></td>
            <td><%= @user.bushou.bushou_name %></td>
            <td><%= @post.title %></td>
            <td><%= @post.body %></td>
            <% if @post.user == current_user %>
            <td><%= link_to "編集", edit_post_path(@post.id), class: "btn btn-outline-success" %>
                <%= link_to "削除", post_path(@post.id), method: :delete, "data-confirm" => "本当に削除しますか？", class: "btn btn-outline-danger" %>
            </td>
            <% end %>
          </tr>
        </tbody>
      </table>
      <div>
        <p>コメント件数：<%= @post.comments.count %></p>
        <% @post.comments.each do |comment| %>
          <%= comment.created_at.strftime('%Y/%m/%d') %>
          <%= comment.user.name %>
          <%= comment.comment %>
          <% if comment.user == current_user %>
          <%= link_to "コメント削除", post_comment_path(@post.id, comment.id), method: :delete %>
          <% end %>

          <% if @post.favorited_by?(current_user) %>
          <%= link_to favorites_path(post_id: @post.id), method: :delete do %>
            ♥<%= @post.favorites.count %> いいね
          <% end %>
        </p>
        <% else %>
        <p>
          <%= link_to favorites_path(post_id: @post.id), method: :post do %>
            ♡<%= @post.favorites.count %> いいね
          <% end %>
        </p>
        <% end %>
      <% end %>
      </div>
      <div>
        <%= form_with model: [@post, @comment] do |f| %>
        <div class="form-group mt-4">
          <%= f.text_area :comment, placeholder: "--コメントする--", class: "form-control" %>
          <div class="mt-3 offset-9"><%= f.submit "送信", class: "px-5" %></div>
        <% end %>
        </div>
      </div>
    </div>
  </div>
</div>